---
title: "Keep your secrets under control - Cryptography for All"
output:
  html_document: default
  html_notebook: default
  pdf_document: default
  word_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

https://www.udemy.com/keep-your-secrets-under-control

#### Disclamer

By joining this course or using material from the course you agree that all materials of the course are solely provided "as is" without any guarantee of functionality. All methods are provided for training purposes. Course developed by non security expert by explaining the practical use of **OpenSSL** software library in `R Statistical Software`. There is a risk that you can loose your information in case you are not properly follow the instructions or by loosing your private key or alike. Make sure you know what you do at any time when using the material of the course. Always test your knowledge on dummy data before applying it to real data... Memory areas for your private key, secrets, or passphrase are not securely cleaned after use. You are using the material of the course at your own risk!

#### Lecture 15 Fast Encryp and Decrypt on Mac with 'bash' scripts

Hello and welcome back to one another lecture about practical use of Public Key Cryptography! This lecture is dedicated for Mac users. If you only use Windows you may simply skip it.

Our goal will be to re-create the concept of usage executable files like we did on Windows machine but now on Mac. Just a side note, Mac OS already uses OpenSSL library but we will want to use it via R Statistical Software.

What I would do now is to create a folder on my Desktop in Mac. This folder will be named '00_RSA'. This folder will contain my passwords, R scripts and executable files. Like in the previous lecture we can encrypt and decrypt our passwords within seconds.

Same idea: fit in the usb key containing Private Key, press one button and get our passwords decrypted. We can then open the file with passwords, check it, close it. Once done we can encrypt our file back by pressing the script Encrypt.sh

This lecture will be about to learn about R on Mac:

* Learn to use Bash terminal
* Learn how to adapt our R scripts to work in this Operating System. 
* Learn to execute our R scripts from Mac with shell script

##### Learn to use Bash Terminal

On Mac you can find analogy of **CMD** on windows which known to be as **Terminal**. You can execute commands there or even store those commands into executable files that are also named 'shell' scripts. Terminal is a kind of a way to get more direct assess to the Operating System and programs installed on it. To try it out you can open 'Terminal' on your Mac. You can practice to execute some code there.

For example, let's use Termanal to find out where our **Rscript** program is installed.  You can type 

```{bash}
#command 'which' finds where the Rscript application is installed
which Rscript
```

in my case, the path of our Rscript program is: **/usr/local/bin/Rscript**

We can simply write in our Terminal this path and provide as an argument the name of our R script to run... We will do that with our R scripts for this lecture but first we need to adapt them to work with this OS

##### Adapt R Scripts for Mac

Our next goal will be to adapt R scripts we had before to run on Mac... You can find these scripts in the repository for this lecture.

The whole idea will be to replace the paths we have to the ones we have on Mac. I will insert my USB key with a **Private.key**. I will then need to find the path of my **private.key**. It's a bit of a cumbersome in Mac. Select the file you want the path and press **CMD+i**. This will bring you the info window. There, find 'where' clause and select the path. Once done press **CMD+c**. You can now paste this path with **CMD+v** to yor Script. It is **/Volumes/PRIVATE/private.key**. We will then need to use this address in our R Script. 

Finally I have modified scripts EncryptM.R and DecryptM.R. You will find that I have defined paths to the private, public keys, passwords in clear text and encrypted form. 

```{r}
# saving path to keys and files
pathPrvKeyUSB <- file.path("/Volumes/PRIVATE/private.key")
pathPubKeyUSB <- file.path("/Volumes/PRIVATE/public.key")
pathPasswFILE <- file.path("/Users/Slava1/Desktop/00_RSA", "passwords.csv")
pathEncryFILE <- file.path("/Users/Slava1/Desktop/00_RSA", "password.Encrypted")
```

The rest of code is exact same as in previous lecture.

Final goal will be to learn how to execute our shell script by doubleclicking on it.

##### Execute our R scripts from Mac with shell script

Notice that I have created the files _Decrypt.sh and _Encrypt.sh

Execute this command on Terminal:

```{bash, eval=FALSE, include=TRUE}
# Making executable shell files (adapt to your user and your path)
chmod a+x /Users/Slava1/Desktop/00_RSA/_Encrypt.sh
```

Then right click and select 'Open With...' click on 'Always open with' select Enable 'All Applications'. Find 'Utilities', Terminal and click open...

You can see that script will be executed... so you can repeat the same for '_Decrypt.sh'

To summarise, in this lecture we have achieved the functionality to encrypt, decrypt our passwords by clicking on the shell script. We got to know how to find path of files in Mac and how to execute R scipts from Shell Scripts...

I hope that you have learnt something new and useful. We have few more concepts to cover. Next one will be about to keep encrypted dataset submitted in the Version Control and available for several collaborators...